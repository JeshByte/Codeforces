So, if we try to create a sequence with only 1,2 and 3 as per the given rules it becomes obvious that the only way to make this sequence is in the form of 1,2,2,...,2,2,3. So we just need to find the number of such possible subsequences. For this we will have to use some math here. Whenever we come across a 2, there are 2 things we need to consider - 
1)There are some existing ways in which subsequences of the form 1,2,2,.. have been formed. Now we can either include or exclude this new 2 in these subsequences. Thus we will have to multiply 2 to the number of ways.
2)Another case is if we start a new form of subsequence where we just pair this new 2 with all the ones before it. So the number of ways to do this will be equal to the number of 1s before this 2. So we will also add this to the number of ways.
When we will come across a 3, we know that all the subsequences of 1,2,2,... that we have formed are now valid by adding this 3. So will add the ways variable that we have maintained till now to our final answer. In this way we can find the answer in an efficient manner.
