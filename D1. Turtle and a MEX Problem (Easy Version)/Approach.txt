For a x, with a given sequence we can set it to at most 2 different values. For example x=2 and the sequence is 1,2,4,4. Here at first we can set x=0. Then if we again use this sequence then we can set it to x=3. But after this if we again use it x would become 0 again. That's why we can go for atmost 2 distinct values. So we can just find these values for all the sequences and find the the max one(say mx). So for all numbers i from 0 to m that are <=mx,f(i)=mx and for the other numbers f(i)=i. We can find this sum using simple maths in O(1). We can use sets to find the 2 candidate MEXs.
